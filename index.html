  <!DOCTYPE html>
  <html lang="en">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mini App</title>
    <link rel="stylesheet" href="styles.css">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
  </head>
  <body>
    <div class="app-container">
      <div class="main-content">
        <div class="wallet">
          <button class="wallet-btn"><i class="fas fa-wallet"></i> Your wallet ‚ñº</button>
          <div class="spiders-count" id="spiderCount">0</div>
          <div class="menu-actions">
            <i class="fas fa-users"></i> Join our community
            <button onclick="window.location.href='https://t.me/spidersbott'">Join our community</button>
          </div>
        </div>

        <!-- –°–µ–∫—Ü–∏—è —Ç–∞–±–ª–∏—Ü—ã –ª–∏–¥–µ—Ä–æ–≤ -->
        <div class="leaders" id="leaders">
          <h2>Leaderboard</h2>
          <p>Total: <span id="totalUsers">0</span> users</p>
          <table>
            <thead>
              <tr>
                <th>Rank</th>
                <th>Avatar</th>
                <th>Name</th>
                <th>Points</th>
              </tr>
            </thead>
            <tbody id="leadersList">
              <!-- –õ–∏–¥–µ—Ä—ã –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª–µ–Ω—ã –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
            </tbody>
          </table>
        </div>
      </div>

      <footer class="nav-footer">
        <button class="nav-btn active"><i class="fas fa-home"></i> Home</button>
        <button class="nav-btn" id="leadersBtn"><i class="fas fa-crown"></i> Leaders</button>
        <button class="nav-btn"><i class="fas fa-user-friends"></i> Friends</button>
        <button class="nav-btn" onclick="toggleTaskList()"><i class="fas fa-dollar-sign"></i> Earn</button>
      </footer>
    </div>

    <div class="task-list" id="taskList">
      <div class="task">
        <div class="task-text">
          <span>Subscribe to Telegram Channel</span>
          <span class="task-reward">+100 SPIDERS</span>
        </div>
        <button data-points="100" data-url="https://t.me/spidersbott">Start</button>
      </div>

      <div class="task">
        <div class="task-text">
          <span>Follow us on Instagram</span>
          <span class="task-reward">+150 SPIDERS</span>
        </div>
        <button data-points="150" data-url="https://instagram.com/qewsob">Start</button>
      </div>
      <button onclick="closeTaskList()" style="margin-top: 15px; padding: 10px; background-color: #4caf50; color: white; border: none; border-radius: 5px;">Close</button>
    </div>



    <script>
      // –û—Å–Ω–æ–≤–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª
      let spiderCount = 0;

      // –ó–∞–≥—Ä—É–∂–∞–µ–º –æ—á–∫–∏ –∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ –∑–∞–¥–∞–Ω–∏—è –∏–∑ localStorage
document.addEventListener('DOMContentLoaded', () => {
  // –ó–∞–≥—Ä—É–∂–∞–µ–º –æ—á–∫–∏ –∏ –∏–º—è —Ç–µ–∫—É—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏–∑ localStorage
  const savedCount = localStorage.getItem('spiderCount');
  spiderCount = savedCount ? parseInt(savedCount) : 0;
  updateSpiderCount();

  // –ó–∞–≥—Ä—É–∂–∞–µ–º –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ –∑–∞–¥–∞–Ω–∏—è
  const completedTasks = JSON.parse(localStorage.getItem('completedTasks')) || [];
  document.querySelectorAll('.task').forEach((task, index) => {
    const button = task.querySelector('button');
    if (completedTasks.includes(index)) {
      markTaskCompleted(task);
    } else {
      button.onclick = function () {
        startTask(button, parseInt(button.getAttribute('data-points')), button.getAttribute('data-url'), index);
      };
    }
  });

  // –ü–æ–ª—É—á–∞–µ–º –∏ —Å–æ—Ö—Ä–∞–Ω—è–µ–º –Ω–∏–∫ Telegram
  let userName = localStorage.getItem('telegramUsername');
  if (!userName) {
    // –ó–∞–ø—Ä–∞—à–∏–≤–∞–µ–º —É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –µ–≥–æ Telegram –Ω–∏–∫
    userName = prompt('Please enter your Telegram username (without @):');
    if (userName) {
      localStorage.setItem('telegramUsername', userName);
    }
  }

  // –ò—â–µ–º —Ç–µ–∫—É—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ —Å–ø–∏—Å–∫–µ –ª–∏–¥–µ—Ä–æ–≤
  const currentPlayerIndex = leaders.findIndex(player => player.name === userName);

  if (currentPlayerIndex === -1) {
    // –ï—Å–ª–∏ —Ç–µ–∫—É—â–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –Ω–∞–π–¥–µ–Ω, –¥–æ–±–∞–≤–ª—è–µ–º –µ–≥–æ –≤ —Å–ø–∏—Å–æ–∫
    const currentPlayer = { name: userName || "Unknown", points: spiderCount, avatar: "https://via.placeholder.com/40?text=Y" };
    leaders.unshift(currentPlayer);  // –î–æ–±–∞–≤–ª—è–µ–º —Ç–µ–∫—É—â–µ–≥–æ –∏–≥—Ä–æ–∫–∞ –≤ –Ω–∞—á–∞–ª–æ —Å–ø–∏—Å–∫–∞
  } else {
    // –ï—Å–ª–∏ —Ç–µ–∫—É—â–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —É–∂–µ –µ—Å—Ç—å, –æ–±–Ω–æ–≤–ª—è–µ–º –µ–≥–æ –æ—á–∫–∏
    leaders[currentPlayerIndex].points = spiderCount;
  }

  // –°–æ—Ä—Ç–∏—Ä—É–µ–º –ª–∏–¥–µ—Ä–æ–≤ –ø–æ –æ—á–∫–∞–º (–ø–æ —É–±—ã–≤–∞–Ω–∏—é)
  leaders.sort((a, b) => b.points - a.points);

  // –°–æ—Ö—Ä–∞–Ω—è–µ–º –æ–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–π —Å–ø–∏—Å–æ–∫ –ª–∏–¥–µ—Ä–æ–≤
  localStorage.setItem("leaders", JSON.stringify(leaders));

  // –û–±–Ω–æ–≤–ª—è–µ–º —Ç–∞–±–ª–∏—Ü—É –ª–∏–¥–µ—Ä–æ–≤
  updateLeaders(leaders, currentPlayerIndex);
});

// –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Ç–∞–±–ª–∏—Ü—ã –ª–∏–¥–µ—Ä–æ–≤
function updateLeaders(leaders, currentPlayerIndex) {
  const leadersList = document.getElementById("leadersList");
  const totalUsers = document.getElementById("totalUsers");

  leadersList.innerHTML = "";
  totalUsers.textContent = leaders.length;

  leaders.forEach((leader, index) => {
    const row = document.createElement("tr");
    let rankIcon = "";

    if (index === 0) rankIcon = 'ü•á';
    else if (index === 1) rankIcon = 'ü•à';
    else if (index === 2) rankIcon = 'ü•â';

    row.innerHTML = `
      <td>${rankIcon || index + 1}</td>
      <td><img src="${leader.avatar}" alt="Avatar" class="avatar"></td>
      <td>${leader.name}</td>
      <td>${leader.points}</td>
    `;

    // –í—ã–¥–µ–ª—è–µ–º —Ç–µ–∫—É—â–µ–≥–æ –∏–≥—Ä–æ–∫–∞
    if (index === currentPlayerIndex) {
      row.style.backgroundColor = "#f0f0f0";  // –í—ã–¥–µ–ª—è–µ–º —Å—Ç—Ä–æ–∫—É —Ç–µ–∫—É—â–µ–≥–æ –∏–≥—Ä–æ–∫–∞
    }

    leadersList.appendChild(row);
  });

  // –ü–æ–∑–∏—Ü–∏—è —Ç–µ–∫—É—â–µ–≥–æ –∏–≥—Ä–æ–∫–∞
  const currentPlayerPosition = currentPlayerIndex + 1;
  alert(`–í–∞—à–µ –º–µ—Å—Ç–æ –≤ —Ç–∞–±–ª–∏—Ü–µ: ${currentPlayerPosition}`);
}




      // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –∏–ª–∏ —Å–∫—Ä—ã—Ç–∏—è —Å–ø–∏—Å–∫–∞ –∑–∞–¥–∞–Ω–∏–π
      function toggleTaskList() {
        const taskList = document.getElementById('taskList');
        taskList.style.display = taskList.style.display === 'block' ? 'none' : 'block';
      }

      function closeTaskList() {
        document.getElementById('taskList').style.display = 'none';
      }

      // –ü–æ–∫–∞–∑–∞—Ç—å –∏–ª–∏ —Å–∫—Ä—ã—Ç—å —Ç–∞–±–ª–∏—Ü—É –ª–∏–¥–µ—Ä–æ–≤
      document.getElementById("leadersBtn").addEventListener("click", () => {
        const leadersDiv = document.getElementById("leaders");
        leadersDiv.style.display = leadersDiv.style.display === "none" || leadersDiv.style.display === "" ? "block" : "none";
      });

      // –ù–∞—á–∞—Ç—å –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∑–∞–¥–∞–Ω–∏—è
      function startTask(button, points, url, taskIndex) {
        window.open(url, '_blank');
        button.textContent = 'Claim';
        button.style.backgroundColor = '#ffc107';
        button.onclick = function () {
          claimTask(button, points, taskIndex);
        };
      }

      // –ó–∞–≤–µ—Ä—à–∏—Ç—å –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∑–∞–¥–∞–Ω–∏—è
      function claimTask(button, points, taskIndex) {
        const task = button.parentElement;
        task.style.textDecoration = 'line-through';
        button.remove();
        addPoints(points);
        saveCompletedTask(taskIndex);
      }

      // –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –æ—á–∫–æ–≤
      function addPoints(points) {
        spiderCount += points;
        updateSpiderCount();
        // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –æ—á–∫–æ–≤ –≤ localStorage
        localStorage.setItem('spiderCount', spiderCount);
      }

      function updateSpiderCount() {
        document.getElementById('spiderCount').textContent = spiderCount;
      }

      // –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ –∑–∞–¥–∞–Ω–∏—è
      function saveCompletedTask(taskIndex) {
        let completedTasks = JSON.parse(localStorage.getItem('completedTasks')) || [];
        completedTasks.push(taskIndex);
        localStorage.setItem('completedTasks', JSON.stringify(completedTasks));
      }

      // –û—Ç–º–µ—Ç–∏—Ç—å –∑–∞–¥–∞–Ω–∏–µ –∫–∞–∫ –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω–æ–µ
      function markTaskCompleted(task) {
        task.style.textDecoration = 'line-through';
        const button = task.querySelector('button');
        if (button) button.remove();
      }
    </script>
  <script src="https://www.gstatic.com/firebasejs/9.19.1/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.19.1/firebase-database.js"></script>

    <script src="leaderboard.js"></script>

  </body>
  </html>
